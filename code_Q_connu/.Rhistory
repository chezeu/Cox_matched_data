alpha_sample=scenarios[i,6]
C=vector()
C[1]=scenarios[i,7]
C[2]=scenarios[i,8]
C[3]=scenarios[i,9]
results_sample<- estimates_survival(nsim=nsim_sample,n=n_sample,m=m_sample,p=p_sample,sigma=sigma_sample,alpha=alpha_sample,C=C, beta, lambda0, beta0)
beta_naive[i,1]<- mean(results_sample$coef_naive_s1)
beta_naive[i,2]<- mean(results_sample$coef_naive_s2)
beta_w_sum1[i,1]<- mean(results_sample$coef_w_sum1_s1)
beta_w_sum1[i,2]<-mean(results_sample$coef_w_sum1_s2)
beta_w_sum2[i,1]<-mean(results_sample$coef_w_sum2_s1)
beta_w_sum2[i,2]<-mean(results_sample$coef_w_sum2_s2)
beta_true[i,1] <-mean(results_sample$coef_true_s1)
beta_true[i,2] <-mean(results_sample$coef_true_s2)
beta_estimate[i,1]<-mean(results_sample$coef_estimate_s1 )
beta_estimate[i,2]<-mean(results_sample$coef_estimate_s2 )
L_naive[i] <- length(which(results_sample$converge_naive==0))
L_w_sum1[i]<- length(which(results_sample$converge_w_sum1==0))
L_w_sum2[i] <-length( which(results_sample$converge_w_sum2==0))
L_estimate[i] <- length(which(results_sample$converge_estimate==0))
Sd_naive[i,1]<-sd( results_sample$coef_naive_s1)
Sd_naive[i,2]<-sd( results_sample$coef_naive_s2)
Sd_sum1[i,1]<-sd(results_sample$coef_w_sum1_s1)
Sd_sum1[i,2] <-sd(results_sample$coef_w_sum1_s2)
Sd_sum2 [i,1]<-sd(results_sample$coef_w_sum2_s1)
Sd_sum2[i,2] <-sd(results_sample$coef_w_sum2_s2)
Sd_true[i,1] <- sd(results_sample$coef_true_s1)
Sd_true[i,2] <- sd(results_sample$coef_true_s2)
Sd_estimate[i,1] <- sd(results_sample$coef_estimate_s1)
Sd_estimate[i,2] <- sd(results_sample$coef_estimate_s2)
}
sigma=1
alpha=1
C_sample=cbind(c(0.6,0.2,0.2),c(0.7,0.15,0.15),c(0.8,0.1,0.1))
m=15
n=10
p=2
nsim=2
beta=c(0.5,-0.5)
lambda0<- rep(0.5,n)
beta0<- c(0.1,0.1)
##############
scenarios=NULL
for (i in 1:ncol(C_sample)){
scenarios=rbind(scenarios,c(nsim,n,m,p,sigma,alpha,C_sample[,i]))
}
colnames(scenarios)=c("nsim","n","m", "p","sigma","alpha","Prob_1","Prob_2","Prob_3")
scenarios=data.frame(scenarios)
################### monte carlos
estimates_survival<- function(nsim,n,m,p,sigma,alpha,C,beta, lambda0,beta0){
coef_true_s<-matrix(0,nrow = nsim, ncol = p)
coef_naive_s<- matrix(0,nrow = nsim, ncol = p)
converge_naive <- vector()
coef_w_sum1_s<- matrix(0,nrow = nsim, ncol = p)
converge_w_sum1 <- vector()
coef_w_sum2_s<- matrix(0,nrow = nsim, ncol = p)
converge_w_sum2 <- vector()
coef_estimate_s <- matrix(0,nrow = nsim, ncol = p)
converge_estimate<- vector()
for (i in 1:nsim){
surv_data =Generate_data(m,n,beta)
g_naive <- doOne2d_equat_estimat(n,m,C,beta,surv_data)
coef_naive_s[i,] <- g_naive$coef_naive2
converge_naive[i] <- g_naive$converge_naive2
g_sum1 <- doOne2d_w_sum1 (n,m,surv_data,C)
coef_w_sum1_s[i,] <- g_sum1$coef_w_sum1
converge_w_sum1[i] <- g_sum1$converge_w_sum1
g_sum2 <- doOne2d_w_sum2 (n,m,surv_data,C)
coef_w_sum2_s[i,] <- g_sum2$coef_w_sum2
converge_w_sum2[i] <- g_sum2$converge_w_sum2
g_estim <- doOne2d_estimate (n,m,C,beta0,lambda0,surv_data)
coef_estimate_s [i,] <- g_estim$coef_estimate
converge_estimate [i] <- as.numeric (g_estim$converge_estimate )
coef_true_s[i,] <- g_estim$coef_true
}
return(list( coef_true_s1=coef_true_s[,1],coef_true_s2=coef_true_s[,2],
coef_naive_s1=coef_naive_s[,1], coef_naive_s2=coef_naive_s[,2], coef_w_sum1_s1=coef_w_sum1_s[,1],coef_w_sum1_s2=coef_w_sum1_s[,2],
coef_w_sum2_s1=coef_w_sum2_s[,1], coef_w_sum2_s2=coef_w_sum2_s[,2],
coef_estimate_s1=coef_estimate_s[,1],coef_estimate_s2=coef_estimate_s[,2],converge_naive=converge_naive, converge_w_sum1=converge_w_sum1,
converge_w_sum2=converge_w_sum2,converge_estimate= converge_estimate))  }
######################################
#results
set.seed(23)
beta_true<- matrix(0,nrow(scenarios),p )
beta_naive<- matrix(0,nrow(scenarios),p )
beta_w_sum1<- matrix(0,nrow(scenarios),p )
beta_w_sum2<- matrix(0,nrow(scenarios),p )
beta_estimate<- matrix(0,nrow(scenarios),p )
L_naive<-vector()
L_w_sum1<-vector()
L_w_sum2<-vector()
L_estimate<-vector()
Sd_naive<-matrix(0,nrow(scenarios),p )
Sd_sum1<- matrix(0,nrow(scenarios),p )
Sd_sum2<-matrix(0,nrow(scenarios),p )
Sd_estimate<-matrix(0,nrow(scenarios),p )
for (i in (1:nrow(scenarios))){
nsim_sample=scenarios[i,1]
n_sample=scenarios[i,2]
m_sample=scenarios[i,3]
p_sample=scenarios[i,4]
sigma_sample=scenarios[i,5]
alpha_sample=scenarios[i,6]
C=vector()
C[1]=scenarios[i,7]
C[2]=scenarios[i,8]
C[3]=scenarios[i,9]
results_sample<- estimates_survival(nsim=nsim_sample,n=n_sample,m=m_sample,p=p_sample,sigma=sigma_sample,alpha=alpha_sample,C=C, beta, lambda0, beta0)
beta_naive[i,1]<- mean(results_sample$coef_naive_s1)
beta_naive[i,2]<- mean(results_sample$coef_naive_s2)
beta_w_sum1[i,1]<- mean(results_sample$coef_w_sum1_s1)
beta_w_sum1[i,2]<-mean(results_sample$coef_w_sum1_s2)
beta_w_sum2[i,1]<-mean(results_sample$coef_w_sum2_s1)
beta_w_sum2[i,2]<-mean(results_sample$coef_w_sum2_s2)
beta_true[i,1] <-mean(results_sample$coef_true_s1)
beta_true[i,2] <-mean(results_sample$coef_true_s2)
beta_estimate[i,1]<-mean(results_sample$coef_estimate_s1 )
beta_estimate[i,2]<-mean(results_sample$coef_estimate_s2 )
L_naive[i] <- length(which(results_sample$converge_naive==0))
L_w_sum1[i]<- length(which(results_sample$converge_w_sum1==0))
L_w_sum2[i] <-length( which(results_sample$converge_w_sum2==0))
L_estimate[i] <- length(which(results_sample$converge_estimate==0))
Sd_naive[i,1]<-sd( results_sample$coef_naive_s1)
Sd_naive[i,2]<-sd( results_sample$coef_naive_s2)
Sd_sum1[i,1]<-sd(results_sample$coef_w_sum1_s1)
Sd_sum1[i,2] <-sd(results_sample$coef_w_sum1_s2)
Sd_sum2 [i,1]<-sd(results_sample$coef_w_sum2_s1)
Sd_sum2[i,2] <-sd(results_sample$coef_w_sum2_s2)
Sd_true[i,1] <- sd(results_sample$coef_true_s1)
Sd_true[i,2] <- sd(results_sample$coef_true_s2)
Sd_estimate[i,1] <- sd(results_sample$coef_estimate_s1)
Sd_estimate[i,2] <- sd(results_sample$coef_estimate_s2)
}
#results
set.seed(23)
beta_true<- matrix(0,nrow(scenarios),p )
beta_naive<- matrix(0,nrow(scenarios),p )
beta_w_sum1<- matrix(0,nrow(scenarios),p )
beta_w_sum2<- matrix(0,nrow(scenarios),p )
beta_estimate<- matrix(0,nrow(scenarios),p )
L_naive<-vector()
L_w_sum1<-vector()
L_w_sum2<-vector()
L_estimate<-vector()
Sd_true<-matrix(0,nrow(scenarios),p )
Sd_naive<-matrix(0,nrow(scenarios),p )
Sd_sum1<- matrix(0,nrow(scenarios),p )
Sd_sum2<-matrix(0,nrow(scenarios),p )
Sd_estimate<-matrix(0,nrow(scenarios),p )
for (i in (1:nrow(scenarios))){
nsim_sample=scenarios[i,1]
n_sample=scenarios[i,2]
m_sample=scenarios[i,3]
p_sample=scenarios[i,4]
sigma_sample=scenarios[i,5]
alpha_sample=scenarios[i,6]
C=vector()
C[1]=scenarios[i,7]
C[2]=scenarios[i,8]
C[3]=scenarios[i,9]
results_sample<- estimates_survival(nsim=nsim_sample,n=n_sample,m=m_sample,p=p_sample,sigma=sigma_sample,alpha=alpha_sample,C=C, beta, lambda0, beta0)
beta_naive[i,1]<- mean(results_sample$coef_naive_s1)
beta_naive[i,2]<- mean(results_sample$coef_naive_s2)
beta_w_sum1[i,1]<- mean(results_sample$coef_w_sum1_s1)
beta_w_sum1[i,2]<-mean(results_sample$coef_w_sum1_s2)
beta_w_sum2[i,1]<-mean(results_sample$coef_w_sum2_s1)
beta_w_sum2[i,2]<-mean(results_sample$coef_w_sum2_s2)
beta_true[i,1] <-mean(results_sample$coef_true_s1)
beta_true[i,2] <-mean(results_sample$coef_true_s2)
beta_estimate[i,1]<-mean(results_sample$coef_estimate_s1 )
beta_estimate[i,2]<-mean(results_sample$coef_estimate_s2 )
L_naive[i] <- length(which(results_sample$converge_naive==0))
L_w_sum1[i]<- length(which(results_sample$converge_w_sum1==0))
L_w_sum2[i] <-length( which(results_sample$converge_w_sum2==0))
L_estimate[i] <- length(which(results_sample$converge_estimate==0))
Sd_naive[i,1]<-sd( results_sample$coef_naive_s1)
Sd_naive[i,2]<-sd( results_sample$coef_naive_s2)
Sd_sum1[i,1]<-sd(results_sample$coef_w_sum1_s1)
Sd_sum1[i,2] <-sd(results_sample$coef_w_sum1_s2)
Sd_sum2 [i,1]<-sd(results_sample$coef_w_sum2_s1)
Sd_sum2[i,2] <-sd(results_sample$coef_w_sum2_s2)
Sd_true[i,1] <- sd(results_sample$coef_true_s1)
Sd_true[i,2] <- sd(results_sample$coef_true_s2)
Sd_estimate[i,1] <- sd(results_sample$coef_estimate_s1)
Sd_estimate[i,2] <- sd(results_sample$coef_estimate_s2)
}
####################
View(beta_estimate)
beta_naive
sigma=1
alpha=1
C_sample=cbind(c(0.6,0.2,0.2),c(0.7,0.15,0.15),c(0.8,0.1,0.1))
m=15
n=10
p=2
nsim=50
beta=c(0.5,-0.5)
lambda0<- rep(0.5,n)
beta0<- c(0.1,0.1)
##############
scenarios=NULL
for (i in 1:ncol(C_sample)){
scenarios=rbind(scenarios,c(nsim,n,m,p,sigma,alpha,C_sample[,i]))
}
colnames(scenarios)=c("nsim","n","m", "p","sigma","alpha","Prob_1","Prob_2","Prob_3")
scenarios=data.frame(scenarios)
################### monte carlos
estimates_survival<- function(nsim,n,m,p,sigma,alpha,C,beta, lambda0,beta0){
coef_true_s<-matrix(0,nrow = nsim, ncol = p)
coef_naive_s<- matrix(0,nrow = nsim, ncol = p)
converge_naive <- vector()
coef_w_sum1_s<- matrix(0,nrow = nsim, ncol = p)
converge_w_sum1 <- vector()
coef_w_sum2_s<- matrix(0,nrow = nsim, ncol = p)
converge_w_sum2 <- vector()
coef_estimate_s <- matrix(0,nrow = nsim, ncol = p)
converge_estimate<- vector()
for (i in 1:nsim){
surv_data =Generate_data(m,n,beta)
g_naive <- doOne2d_equat_estimat(n,m,C,beta,surv_data)
coef_naive_s[i,] <- g_naive$coef_naive2
converge_naive[i] <- g_naive$converge_naive2
g_sum1 <- doOne2d_w_sum1 (n,m,surv_data,C)
coef_w_sum1_s[i,] <- g_sum1$coef_w_sum1
converge_w_sum1[i] <- g_sum1$converge_w_sum1
g_sum2 <- doOne2d_w_sum2 (n,m,surv_data,C)
coef_w_sum2_s[i,] <- g_sum2$coef_w_sum2
converge_w_sum2[i] <- g_sum2$converge_w_sum2
g_estim <- doOne2d_estimate (n,m,C,beta0,lambda0,surv_data)
coef_estimate_s [i,] <- g_estim$coef_estimate
converge_estimate [i] <- as.numeric (g_estim$converge_estimate )
coef_true_s[i,] <- g_estim$coef_true
}
return(list( coef_true_s1=coef_true_s[,1],coef_true_s2=coef_true_s[,2],
coef_naive_s1=coef_naive_s[,1], coef_naive_s2=coef_naive_s[,2], coef_w_sum1_s1=coef_w_sum1_s[,1],coef_w_sum1_s2=coef_w_sum1_s[,2],
coef_w_sum2_s1=coef_w_sum2_s[,1], coef_w_sum2_s2=coef_w_sum2_s[,2],
coef_estimate_s1=coef_estimate_s[,1],coef_estimate_s2=coef_estimate_s[,2],converge_naive=converge_naive, converge_w_sum1=converge_w_sum1,
converge_w_sum2=converge_w_sum2,converge_estimate= converge_estimate))  }
######################################
#results
set.seed(23)
beta_true<- matrix(0,nrow(scenarios),p )
beta_naive<- matrix(0,nrow(scenarios),p )
beta_w_sum1<- matrix(0,nrow(scenarios),p )
beta_w_sum2<- matrix(0,nrow(scenarios),p )
beta_estimate<- matrix(0,nrow(scenarios),p )
L_naive<-vector()
L_w_sum1<-vector()
L_w_sum2<-vector()
L_estimate<-vector()
Sd_true<-matrix(0,nrow(scenarios),p )
Sd_naive<-matrix(0,nrow(scenarios),p )
Sd_sum1<- matrix(0,nrow(scenarios),p )
Sd_sum2<-matrix(0,nrow(scenarios),p )
Sd_estimate<-matrix(0,nrow(scenarios),p )
for (i in (1:nrow(scenarios))){
nsim_sample=scenarios[i,1]
n_sample=scenarios[i,2]
m_sample=scenarios[i,3]
p_sample=scenarios[i,4]
sigma_sample=scenarios[i,5]
alpha_sample=scenarios[i,6]
C=vector()
C[1]=scenarios[i,7]
C[2]=scenarios[i,8]
C[3]=scenarios[i,9]
results_sample<- estimates_survival(nsim=nsim_sample,n=n_sample,m=m_sample,p=p_sample,sigma=sigma_sample,alpha=alpha_sample,C=C, beta, lambda0, beta0)
beta_naive[i,1]<- mean(results_sample$coef_naive_s1)
beta_naive[i,2]<- mean(results_sample$coef_naive_s2)
beta_w_sum1[i,1]<- mean(results_sample$coef_w_sum1_s1)
beta_w_sum1[i,2]<-mean(results_sample$coef_w_sum1_s2)
beta_w_sum2[i,1]<-mean(results_sample$coef_w_sum2_s1)
beta_w_sum2[i,2]<-mean(results_sample$coef_w_sum2_s2)
beta_true[i,1] <-mean(results_sample$coef_true_s1)
beta_true[i,2] <-mean(results_sample$coef_true_s2)
beta_estimate[i,1]<-mean(results_sample$coef_estimate_s1 )
beta_estimate[i,2]<-mean(results_sample$coef_estimate_s2 )
L_naive[i] <- length(which(results_sample$converge_naive==0))
L_w_sum1[i]<- length(which(results_sample$converge_w_sum1==0))
L_w_sum2[i] <-length( which(results_sample$converge_w_sum2==0))
L_estimate[i] <- length(which(results_sample$converge_estimate==0))
Sd_naive[i,1]<-sd( results_sample$coef_naive_s1)
Sd_naive[i,2]<-sd( results_sample$coef_naive_s2)
Sd_sum1[i,1]<-sd(results_sample$coef_w_sum1_s1)
Sd_sum1[i,2] <-sd(results_sample$coef_w_sum1_s2)
Sd_sum2 [i,1]<-sd(results_sample$coef_w_sum2_s1)
Sd_sum2[i,2] <-sd(results_sample$coef_w_sum2_s2)
Sd_true[i,1] <- sd(results_sample$coef_true_s1)
Sd_true[i,2] <- sd(results_sample$coef_true_s2)
Sd_estimate[i,1] <- sd(results_sample$coef_estimate_s1)
Sd_estimate[i,2] <- sd(results_sample$coef_estimate_s2)
}
beta_naive
sigma=1
alpha=1
C_sample=cbind(c(0.6,0.2,0.2),c(0.7,0.15,0.15),c(0.8,0.1,0.1))
m=100
n=80
p=2
nsim=50
beta=c(0.5,-0.5)
lambda0<- rep(0.5,n)
beta0<- c(0.1,0.1)
##############
scenarios=NULL
for (i in 1:ncol(C_sample)){
scenarios=rbind(scenarios,c(nsim,n,m,p,sigma,alpha,C_sample[,i]))
}
colnames(scenarios)=c("nsim","n","m", "p","sigma","alpha","Prob_1","Prob_2","Prob_3")
scenarios=data.frame(scenarios)
################### monte carlos
estimates_survival<- function(nsim,n,m,p,sigma,alpha,C,beta, lambda0,beta0){
coef_true_s<-matrix(0,nrow = nsim, ncol = p)
coef_naive_s<- matrix(0,nrow = nsim, ncol = p)
converge_naive <- vector()
coef_w_sum1_s<- matrix(0,nrow = nsim, ncol = p)
converge_w_sum1 <- vector()
coef_w_sum2_s<- matrix(0,nrow = nsim, ncol = p)
converge_w_sum2 <- vector()
coef_estimate_s <- matrix(0,nrow = nsim, ncol = p)
converge_estimate<- vector()
for (i in 1:nsim){
surv_data =Generate_data(m,n,beta)
g_naive <- doOne2d_equat_estimat(n,m,C,beta,surv_data)
coef_naive_s[i,] <- g_naive$coef_naive2
converge_naive[i] <- g_naive$converge_naive2
g_sum1 <- doOne2d_w_sum1 (n,m,surv_data,C)
coef_w_sum1_s[i,] <- g_sum1$coef_w_sum1
converge_w_sum1[i] <- g_sum1$converge_w_sum1
g_sum2 <- doOne2d_w_sum2 (n,m,surv_data,C)
coef_w_sum2_s[i,] <- g_sum2$coef_w_sum2
converge_w_sum2[i] <- g_sum2$converge_w_sum2
g_estim <- doOne2d_estimate (n,m,C,beta0,lambda0,surv_data)
coef_estimate_s [i,] <- g_estim$coef_estimate
converge_estimate [i] <- as.numeric (g_estim$converge_estimate )
coef_true_s[i,] <- g_estim$coef_true
}
return(list( coef_true_s1=coef_true_s[,1],coef_true_s2=coef_true_s[,2],
coef_naive_s1=coef_naive_s[,1], coef_naive_s2=coef_naive_s[,2], coef_w_sum1_s1=coef_w_sum1_s[,1],coef_w_sum1_s2=coef_w_sum1_s[,2],
coef_w_sum2_s1=coef_w_sum2_s[,1], coef_w_sum2_s2=coef_w_sum2_s[,2],
coef_estimate_s1=coef_estimate_s[,1],coef_estimate_s2=coef_estimate_s[,2],converge_naive=converge_naive, converge_w_sum1=converge_w_sum1,
converge_w_sum2=converge_w_sum2,converge_estimate= converge_estimate))  }
######################################
#results
set.seed(23)
beta_true<- matrix(0,nrow(scenarios),p )
beta_naive<- matrix(0,nrow(scenarios),p )
beta_w_sum1<- matrix(0,nrow(scenarios),p )
beta_w_sum2<- matrix(0,nrow(scenarios),p )
beta_estimate<- matrix(0,nrow(scenarios),p )
L_naive<-vector()
L_w_sum1<-vector()
L_w_sum2<-vector()
L_estimate<-vector()
Sd_true<-matrix(0,nrow(scenarios),p )
Sd_naive<-matrix(0,nrow(scenarios),p )
Sd_sum1<- matrix(0,nrow(scenarios),p )
Sd_sum2<-matrix(0,nrow(scenarios),p )
Sd_estimate<-matrix(0,nrow(scenarios),p )
for (i in (1:nrow(scenarios))){
nsim_sample=scenarios[i,1]
n_sample=scenarios[i,2]
m_sample=scenarios[i,3]
p_sample=scenarios[i,4]
sigma_sample=scenarios[i,5]
alpha_sample=scenarios[i,6]
C=vector()
C[1]=scenarios[i,7]
C[2]=scenarios[i,8]
C[3]=scenarios[i,9]
results_sample<- estimates_survival(nsim=nsim_sample,n=n_sample,m=m_sample,p=p_sample,sigma=sigma_sample,alpha=alpha_sample,C=C, beta, lambda0, beta0)
beta_naive[i,1]<- mean(results_sample$coef_naive_s1)
beta_naive[i,2]<- mean(results_sample$coef_naive_s2)
beta_w_sum1[i,1]<- mean(results_sample$coef_w_sum1_s1)
beta_w_sum1[i,2]<-mean(results_sample$coef_w_sum1_s2)
beta_w_sum2[i,1]<-mean(results_sample$coef_w_sum2_s1)
beta_w_sum2[i,2]<-mean(results_sample$coef_w_sum2_s2)
beta_true[i,1] <-mean(results_sample$coef_true_s1)
beta_true[i,2] <-mean(results_sample$coef_true_s2)
beta_estimate[i,1]<-mean(results_sample$coef_estimate_s1 )
beta_estimate[i,2]<-mean(results_sample$coef_estimate_s2 )
L_naive[i] <- length(which(results_sample$converge_naive==0))
L_w_sum1[i]<- length(which(results_sample$converge_w_sum1==0))
L_w_sum2[i] <-length( which(results_sample$converge_w_sum2==0))
L_estimate[i] <- length(which(results_sample$converge_estimate==0))
Sd_naive[i,1]<-sd( results_sample$coef_naive_s1)
Sd_naive[i,2]<-sd( results_sample$coef_naive_s2)
Sd_sum1[i,1]<-sd(results_sample$coef_w_sum1_s1)
Sd_sum1[i,2] <-sd(results_sample$coef_w_sum1_s2)
Sd_sum2 [i,1]<-sd(results_sample$coef_w_sum2_s1)
Sd_sum2[i,2] <-sd(results_sample$coef_w_sum2_s2)
Sd_true[i,1] <- sd(results_sample$coef_true_s1)
Sd_true[i,2] <- sd(results_sample$coef_true_s2)
Sd_estimate[i,1] <- sd(results_sample$coef_estimate_s1)
Sd_estimate[i,2] <- sd(results_sample$coef_estimate_s2)
}
####################
View(beta_estimate)
View(beta_naive)
View(beta_true)
View(beta_w_sum1)
View(beta_w_sum2)
View(beta_estimate)
View(Sd_naive)
View(Sd_sum1)
View(Sd_sum2)
View(Sd_estimate)
sigma=1
alpha=1
C_sample=cbind(c(0.6,0.2,0.2),c(0.7,0.15,0.15),c(0.8,0.1,0.1))
m=600
n=480
p=2
nsim=100
beta=c(0.5,-0.5)
lambda0<- rep(0.5,n)
beta0<- c(0.1,0.1)
##############
scenarios=NULL
for (i in 1:ncol(C_sample)){
scenarios=rbind(scenarios,c(nsim,n,m,p,sigma,alpha,C_sample[,i]))
}
colnames(scenarios)=c("nsim","n","m", "p","sigma","alpha","Prob_1","Prob_2","Prob_3")
scenarios=data.frame(scenarios)
################### monte carlos
estimates_survival<- function(nsim,n,m,p,sigma,alpha,C,beta, lambda0,beta0){
coef_true_s<-matrix(0,nrow = nsim, ncol = p)
coef_naive_s<- matrix(0,nrow = nsim, ncol = p)
converge_naive <- vector()
coef_w_sum1_s<- matrix(0,nrow = nsim, ncol = p)
converge_w_sum1 <- vector()
coef_w_sum2_s<- matrix(0,nrow = nsim, ncol = p)
converge_w_sum2 <- vector()
coef_estimate_s <- matrix(0,nrow = nsim, ncol = p)
converge_estimate<- vector()
for (i in 1:nsim){
surv_data =Generate_data(m,n,beta)
g_naive <- doOne2d_equat_estimat(n,m,C,beta,surv_data)
coef_naive_s[i,] <- g_naive$coef_naive2
converge_naive[i] <- g_naive$converge_naive2
g_sum1 <- doOne2d_w_sum1 (n,m,surv_data,C)
coef_w_sum1_s[i,] <- g_sum1$coef_w_sum1
converge_w_sum1[i] <- g_sum1$converge_w_sum1
g_sum2 <- doOne2d_w_sum2 (n,m,surv_data,C)
coef_w_sum2_s[i,] <- g_sum2$coef_w_sum2
converge_w_sum2[i] <- g_sum2$converge_w_sum2
g_estim <- doOne2d_estimate (n,m,C,beta0,lambda0,surv_data)
coef_estimate_s [i,] <- g_estim$coef_estimate
converge_estimate [i] <- as.numeric (g_estim$converge_estimate )
coef_true_s[i,] <- g_estim$coef_true
}
return(list( coef_true_s1=coef_true_s[,1],coef_true_s2=coef_true_s[,2],
coef_naive_s1=coef_naive_s[,1], coef_naive_s2=coef_naive_s[,2], coef_w_sum1_s1=coef_w_sum1_s[,1],coef_w_sum1_s2=coef_w_sum1_s[,2],
coef_w_sum2_s1=coef_w_sum2_s[,1], coef_w_sum2_s2=coef_w_sum2_s[,2],
coef_estimate_s1=coef_estimate_s[,1],coef_estimate_s2=coef_estimate_s[,2],converge_naive=converge_naive, converge_w_sum1=converge_w_sum1,
converge_w_sum2=converge_w_sum2,converge_estimate= converge_estimate))  }
######################################
#results
set.seed(23)
beta_true<- matrix(0,nrow(scenarios),p )
beta_naive<- matrix(0,nrow(scenarios),p )
beta_w_sum1<- matrix(0,nrow(scenarios),p )
beta_w_sum2<- matrix(0,nrow(scenarios),p )
beta_estimate<- matrix(0,nrow(scenarios),p )
L_naive<-vector()
L_w_sum1<-vector()
L_w_sum2<-vector()
L_estimate<-vector()
Sd_true<-matrix(0,nrow(scenarios),p )
Sd_naive<-matrix(0,nrow(scenarios),p )
Sd_sum1<- matrix(0,nrow(scenarios),p )
Sd_sum2<-matrix(0,nrow(scenarios),p )
Sd_estimate<-matrix(0,nrow(scenarios),p )
for (i in (1:nrow(scenarios))){
nsim_sample=scenarios[i,1]
n_sample=scenarios[i,2]
m_sample=scenarios[i,3]
p_sample=scenarios[i,4]
sigma_sample=scenarios[i,5]
alpha_sample=scenarios[i,6]
C=vector()
C[1]=scenarios[i,7]
C[2]=scenarios[i,8]
C[3]=scenarios[i,9]
results_sample<- estimates_survival(nsim=nsim_sample,n=n_sample,m=m_sample,p=p_sample,sigma=sigma_sample,alpha=alpha_sample,C=C, beta, lambda0, beta0)
beta_naive[i,1]<- mean(results_sample$coef_naive_s1)
beta_naive[i,2]<- mean(results_sample$coef_naive_s2)
beta_w_sum1[i,1]<- mean(results_sample$coef_w_sum1_s1)
beta_w_sum1[i,2]<-mean(results_sample$coef_w_sum1_s2)
beta_w_sum2[i,1]<-mean(results_sample$coef_w_sum2_s1)
beta_w_sum2[i,2]<-mean(results_sample$coef_w_sum2_s2)
beta_true[i,1] <-mean(results_sample$coef_true_s1)
beta_true[i,2] <-mean(results_sample$coef_true_s2)
beta_estimate[i,1]<-mean(results_sample$coef_estimate_s1 )
beta_estimate[i,2]<-mean(results_sample$coef_estimate_s2 )
L_naive[i] <- length(which(results_sample$converge_naive==0))
L_w_sum1[i]<- length(which(results_sample$converge_w_sum1==0))
L_w_sum2[i] <-length( which(results_sample$converge_w_sum2==0))
L_estimate[i] <- length(which(results_sample$converge_estimate==0))
Sd_naive[i,1]<-sd( results_sample$coef_naive_s1)
Sd_naive[i,2]<-sd( results_sample$coef_naive_s2)
Sd_sum1[i,1]<-sd(results_sample$coef_w_sum1_s1)
Sd_sum1[i,2] <-sd(results_sample$coef_w_sum1_s2)
Sd_sum2 [i,1]<-sd(results_sample$coef_w_sum2_s1)
Sd_sum2[i,2] <-sd(results_sample$coef_w_sum2_s2)
Sd_true[i,1] <- sd(results_sample$coef_true_s1)
Sd_true[i,2] <- sd(results_sample$coef_true_s2)
Sd_estimate[i,1] <- sd(results_sample$coef_estimate_s1)
Sd_estimate[i,2] <- sd(results_sample$coef_estimate_s2)
}
####################
View(beta_estimate)
